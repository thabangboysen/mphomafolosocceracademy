<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Payment - Mpho Mafolo Soccer Academy</title>
  <link rel="stylesheet" href="/CSS/payment.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Complete Your Registration</h1>
      <p>Secure Payment via PayFast - South Africa's Leading Payment Gateway</p>
    </div>

    <div class="payment-content">
      <!-- Order Summary -->
      <div class="order-summary">
        <h2>Payment Summary</h2>
        
        <div class="summary-item">
          <span class="item-description">Registration Fee</span>
          <span class="item-price">R800.00</span>
        </div>
        
        <div class="summary-item">
          <span class="item-description">Team Kit Included</span>
          <span class="item-price">Included</span>
        </div>
        
        <div class="summary-item total-item">
          <span class="item-description">Total Amount</span>
          <span class="item-price">R800.00</span>
        </div>

        <div class="player-info">
          <h3>Player Details</h3>
          <div class="player-details">
            <p><strong>Name:</strong> <span id="playerNameDisplay">Loading...</span></p>
            <p><strong>Age Group:</strong> U11 (5-13 years)</p>
            <p><strong>Training:</strong> Saturdays 09:00-11:00</p>
            <p><strong>Venue:</strong> TUT eMalahleni Sports Field</p>
          </div>
        </div>
      </div>

      <!-- Payment Form -->
      <div class="payment-form">
        <div class="setup-notice">
          <h3>‚öôÔ∏è Setup Required</h3>
          <p><strong>To enable real payments, complete these steps:</strong></p>
          <ol>
            <li>Sign up at <a href="https://www.payfast.co.za" target="_blank">payfast.co.za</a></li>
            <li>Complete merchant verification (2-5 business days)</li>
            <li>Get your Merchant ID and Merchant Key</li>
            <li>Replace the placeholders in the code with your credentials</li>
            <li>Set your passphrase in PayFast dashboard</li>
          </ol>
          <p style="margin-top:15px; font-weight:600; color:#92400E;">Once setup, this page will process real payments directly to your Capitec account (2016465480).</p>
        </div>

        <div class="form-section">
          <h3>Payment Information</h3>
          
          <div class="payment-gateway-info">
            <div class="gateway-logos">
              <div class="gateway-logo">PayFast</div>
              <div class="gateway-logo">Visa</div>
              <div class="gateway-logo">Mastercard</div>
              <div class="gateway-logo">EFT</div>
            </div>
            <p style="color:#1E40AF; font-weight:600; margin-bottom:10px;">Accepted Payment Methods:</p>
            <p style="color:#475569; font-size:0.9rem; font-weight:500;">Credit/Debit Cards, Instant EFT, SnapScan, Zapper, and more</p>
            <div class="security-badges">
              <span class="badge">PCI-DSS Compliant</span>
              <span class="badge">256-bit SSL</span>
              <span class="badge">3D Secure</span>
            </div>
          </div>

          <form id="paymentForm" action="https://www.payfast.co.za/eng/process" method="POST">
            <!-- PayFast Required Fields -->
            <input type="hidden" name="merchant_id" value="YOUR_MERCHANT_ID">
            <input type="hidden" name="merchant_key" value="YOUR_MERCHANT_KEY">
            <input type="hidden" name="return_url" value="https://yourwebsite.com/payment-success.html">
            <input type="hidden" name="cancel_url" value="https://yourwebsite.com/payment-cancelled.html">
            <input type="hidden" name="notify_url" value="https://yourwebsite.com/payment-notify.php">
            
            <!-- Transaction Details -->
            <input type="hidden" name="amount" value="800.00">
            <input type="hidden" name="item_name" value="MMSA Registration Fee + Team Kit">
            <input type="hidden" name="item_description" id="itemDescription" value="Registration for Player">
            
            <!-- Customer Details -->
            <div class="form-group">
              <label for="name_first">First Name *</label>
              <input type="text" id="name_first" name="name_first" required>
            </div>

            <div class="form-group">
              <label for="name_last">Last Name *</label>
              <input type="text" id="name_last" name="name_last" required>
            </div>

            <div class="form-group">
              <label for="email_address">Email Address *</label>
              <input type="email" id="email_address" name="email_address" required>
            </div>

            <div class="form-group">
              <label for="cell_number">Cell Number *</label>
              <input type="tel" id="cell_number" name="cell_number" placeholder="0821234567" pattern="[0-9]{10}" required>
            </div>

            <!-- Hidden signature field - will be generated -->
            <input type="hidden" name="signature" id="signature" value="">

            <div class="security-notice">
              <div class="security-icon">üîí</div>
              <div class="security-text">
                <strong>Your Payment is 100% Secure</strong>
                <p>Processed by PayFast, South Africa's most trusted payment gateway. Your banking details are never stored on our servers. All transactions are encrypted and PCI-DSS compliant.</p>
              </div>
            </div>

            <div class="payment-buttons">
              <button type="button" class="btn-secondary" onclick="goBack()">Go Back</button>
              <button type="submit" class="btn-primary">Pay R800.00 Now</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Processing Modal -->
  <div id="processingModal" class="processing-modal">
    <div class="processing-content">
      <div class="spinner"></div>
      <h3>Redirecting to PayFast...</h3>
      <p>Please wait while we redirect you to our secure payment gateway.</p>
    </div>
  </div>

  <script>
    // Load player name from URL or storage
    window.addEventListener('load', function() {
      const urlParams = new URLSearchParams(window.location.search);
      const playerName = urlParams.get('player');
      
      if (playerName) {
        document.getElementById('playerNameDisplay').textContent = playerName;
        document.getElementById('itemDescription').value = 'MMSA Registration for ' + playerName;
      } else {
        document.getElementById('playerNameDisplay').textContent = 'New Player';
      }
    });

    function goBack() {
      if (confirm('Are you sure you want to go back? You will need to re-enter your details.')) {
        window.history.back();
      }
    }

    // Handle form submission
    document.getElementById('paymentForm').addEventListener('submit', function(e) {
      // Show processing modal
      document.getElementById('processingModal').style.display = 'block';
      
      // Note: In production, you would generate the signature server-side
      // The signature is an MD5 hash of all the payment parameters
      // For security, this MUST be done on your server, not in JavaScript
      
      // Form will submit to PayFast after a brief delay
      setTimeout(function() {
        // Form submits naturally to PayFast
      }, 1000);
    });

    // Format phone number
    document.getElementById('cell_number').addEventListener('input', function(e) {
      e.target.value = e.target.value.replace(/\D/g, '').slice(0, 10);
    });
  </script>
</body>
</html>